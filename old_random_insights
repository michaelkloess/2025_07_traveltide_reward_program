
Annahme: Kündigen die Leute, weil ihnen ein Rabbat versprochen wurde, den man dann nicht gewährt hat bzw. verrechnet wurde?


-- Flug und Hotel wurde gebucht und dann wieder stoniert. Es 

select count(*)
from sessions
where cancellation = false					
and flight_booked = true					
and hotel_booked = true	
and flight_discount = true 
and hotel_discount = true
and flight_discount_amount is null 			
and hotel_discount_amount is null  

========
Output: 0
========


-- Flug und Hotel wurden nach der Buchung nicht stoniert. Es gab auch keinen Rabatt. 

select *
from sessions
where cancellation = false					
and flight_booked = true					
and hotel_booked = true						
and flight_discount_amount is null 			
and hotel_discount_amount is null

========
Output: 1.181.744
========

-- Hotel und Flug wurden gebucht. Flug und Hotelrabatt wurden aktiviert. Die Rabatts wurden aber nicht angerechnet. Jahresvergleich. 

select 
CASE
		WHEN EXTRACT(YEAR FROM session_start) = 2021 THEN '2021'
		WHEN EXTRACT(YEAR FROM session_start) = 2022 THEN '2022'
		WHEN EXTRACT(YEAR FROM session_start) = 2023 THEN '2023'
		ELSE 'Unknown'
		END AS year_name,
		count(*)
from sessions
where cancellation = true					
and flight_booked = true					
and hotel_booked = true	
and flight_discount = true 
and hotel_discount = true
and flight_discount_amount is null 			
and hotel_discount_amount is null
group by year_name;

========
Output: 


year_name|count|
---------+-----+
2021     | 3132|
2022     |32700|
2023     |54838|

========


Gibt es einen Fluganbieter oder einen Hotelanbieter, die Leute mit falschen Angeboten locken?









